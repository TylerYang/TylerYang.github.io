<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Promise Land</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Tyler&apos;s Zend Garden">
<meta property="og:type" content="website">
<meta property="og:title" content="Promise Land">
<meta property="og:url" content="tyleryang.github.io/index.html">
<meta property="og:site_name" content="Promise Land">
<meta property="og:description" content="Tyler&apos;s Zend Garden">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Promise Land">
<meta name="twitter:description" content="Tyler&apos;s Zend Garden">
  
  
    <link rel="icon" href="favicon.png">
  
  <link href='//fonts.useso.com/css?family=Open+Sans:400italic,400,600' rel='stylesheet' type='text/css'>
  <link href="//fonts.useso.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/style.css" type="text/css">
  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css" type="text/css">
  

  
<script type="text/javascript">
var _hmt = _hmt || [];
(function() {
      var hm = document.createElement("script");
        hm.src = "//hm.baidu.com/hm.js?136f9d0455315c9611ba56b53088b6f9";
          var s = document.getElementsByTagName("script")[0]; 
            s.parentNode.insertBefore(hm, s);
})();
</script>


  
</head>

<body>
  <div id="container">
    <header id="header">
  <div id="header-main" class="header-inner">
    <div class="outer">
      <a href="/" id="logo"><i class="logo" style="background-image: url(/css/images/logo.png)"></i><span class="site-title">Promise Land</span></a>
      <nav id="main-nav">
        
          <a class="main-nav-link" href="/.">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/categories">Categories</a>
        
          <a class="main-nav-link" href="/tags">Tags</a>
        
          <a class="main-nav-link" href="/about">About</a>
        
      </nav>
      
        <nav id="sub-nav">
          <div class="profile" id="profile-nav">
            <a id="profile-anchor" href="javascript:;"><img class="avatar" src="https://avatars2.githubusercontent.com/u/5443053?%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20v=3&amp;u=be0550961d4346b67d803ea9902fd8beb4ca519f&amp;s=140"><i class="fa fa-caret-down"></i></a>
          </div>
        </nav>
      
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit"> </button><input type="hidden" name="sitesearch" value="tyleryang.github.io"></form>
      </div>
    </div>
  </div>
  <div id="main-nav-mobile" class="header-sub header-inner">
    <table class="menu outer">
      <tr>
        
          <td><a class="main-nav-link" href="/.">Home</a></td>
        
          <td><a class="main-nav-link" href="/archives">Archives</a></td>
        
          <td><a class="main-nav-link" href="/categories">Categories</a></td>
        
          <td><a class="main-nav-link" href="/tags">Tags</a></td>
        
          <td><a class="main-nav-link" href="/about">About</a></td>
        
        <td>
          <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><input type="hidden" name="sitesearch" value="tyleryang.github.io"></form>
        </td>
      </tr>
    </table>
  </div>
</header>

    <div class="outer">
      
        <aside id="profile">
  <div class="inner profile-inner">
    <div class="base-info profile-block">
      <img id="avatar" src="https://avatars2.githubusercontent.com/u/5443053?%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20v=3&amp;u=be0550961d4346b67d803ea9902fd8beb4ca519f&amp;s=140">
      <h2 id="name">Tyler Yang</h2>
      <h3 id="title">Web Developer</h3>
      <span id="location"><i class="fa fa-map-marker"></i>ShenZhen, GuangDong, China</span>
      <a id="follow" href="https://github.com/TylerYang/">FOLLOW</a>
    </div>
    <div class="article-info profile-block">
      <div class="article-info-block">
        12
        <span>posts</span>
      </div>
      <div class="article-info-block">
        13
        <span>tags</span>
      </div>
    </div>
    
    <div class="contact-info profile-block">
      <table class="contact-list">
        <tr>
          
          <td><a href="http://github.com/TylerYang" target="_blank" title="github"><i class="fa fa-github"></i></a></td>
          
          <td><a href="http://stackoverflow.com/users/3064056/tyler-z-yang" target="_blank" title="stack-overflow"><i class="fa fa-stack-overflow"></i></a></td>
          
          <td><a href="/atom.xml" target="_blank" title="rss"><i class="fa fa-rss"></i></a></td>
          
        </tr>
      </table>
    </div>
    
    
  </div>
</aside>

      
      <section id="main">
      <article id="post-饿了么网站优化研究-web" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/10/16/饿了么网站优化研究-web/">饿了么网站优化研究 - web</a>
    </h1>
  

        <div class="article-meta">
          
  <div class="article-date">
    <i class="fa fa-calendar"></i>
    <a href="/2015/10/16/饿了么网站优化研究-web/">
      <time datetime="2015-10-16T06:06:20.000Z" itemprop="datePublished">2015-10-16</time>
    </a>
  </div>


          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/categories/web/">web</a><i class="fa fa-angle-right"></i><a class="article-category-link" href="/categories/web/architecture/">architecture</a>
  </div>

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>最近都在弄移动端网站加载的优化，特地看了下饿了么网站的优化方式。<a href="m.ele.me">饿了么移动端</a>使用Angular 进行开发，蛮值得研究下加载优化的。</p>
<p>这是移动端在3g 网络情况下的加载截图,<br><img src="https://raw.githubusercontent.com/TylerYang/images/master/blog/m.ele.me.png" alt="饿了么首页加载图"></p>
<p>一个有趣的地方在于script tag 不再像传统的html页面放到body的结束处，原因在于m.ele.me采用angular进行开发，必须通过script 进行bootstrap，所以优先加载script。</p>
<p>从这张图的左边可以看出饿了么加载的几个主要scripts 分别为lib, app, template, svg template, crayfish.</p>
<p>其中template 为html 转化为js, 并通过<code>$templateCache</code>进行缓存。 svg template 为svg 转化为 tag 再通过 <code>$templateCache</code>进行缓存。 具体拿出svg 的cache 可以通过如下代码拿到对应的svg。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> $injector = angular.element(<span class="built_in">document</span>.body).injector();</span><br><span class="line"><span class="keyword">var</span> $templateCache = $injector.get(<span class="string">"$templateCache"</span>);</span><br><span class="line"><span class="keyword">var</span> svgTag = $templateCache.get(<span class="string">"/msite/svg-inline/app-link-logo.svg"</span>);</span><br><span class="line"><span class="built_in">console</span>.log(svgTag);</span><br></pre></td></tr></table></figure>
<p>注意到这个截图里面的 batch, 发送的url 为<code>http://m.ele.me.restapi/batch</code> , Request Payload 为<code>[{method: &quot;POST&quot;, url: &quot;/v1/csrf_token&quot;}, {method: &quot;GET&quot;, url: &quot;/v1/user?extras%5B%5D=premium_vip&quot;}]</code> 看来是批量请求合并，好奇他们的实现方式，于是查看了下代码里面的module, 发现整个eleme 的app 分为四个module, <code>meleme</code>, <code>meleme.main</code>, <code>batchrequest</code> 以及 <code>meleme.test</code>(看来是用于跑测试用例的时候)， 其中<code>meleme.main</code> 依赖于<code>batchrequest</code>，<code>batchrequest</code>依赖于<code>httpHook</code>, <code>httpHook</code> 做的事情还蛮简单的，正则匹配到对应请求，回调一下, 并没有太多可以说的。</p>
<p>倒是对以下代码表示理解不能啊。</p>
<p><img src="https://raw.githubusercontent.com/TylerYang/images/master/blog/m.ele.me.code.png" alt="饿了么代码截图"></p>
<p>最后觉得他们首次加载的template 在gzip压缩后的大小为200KB，远大于lib 的85KB 以及app 的42KB。是否可以根据当前url 进行分次加载templateCache? </p>
<p>200KB = 200 <em> 1000 Byte 在3G Regular 的网络情况（750Kbps) 需要时间为 200 </em> 8 / 750 超过2s 的纯粹传输时间，在带宽无法完全独有的情况下，加上连接时间会超过3s。 也就是说 template的加载在这个时候反而成为瓶颈。 </p>
<p>关于网络传输容易搞混的地方<br>750Kbps =&gt; 750 * 1000 bits per second.  Kb =&gt; kilo bits,  KB =&gt; kilo bytes</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="tyleryang.github.io/2015/10/16/饿了么网站优化研究-web/" data-id="cift9a0o50002t342oh478zck" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/web/">web</a></li></ul>

    </footer>
  </div>
  
</article>



    
      <article id="post-Save-Beta-Rabbit-Google-Challenge" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/10/13/Save-Beta-Rabbit-Google-Challenge/">Save Beta Rabbit - Google Challenge</a>
    </h1>
  

        <div class="article-meta">
          
  <div class="article-date">
    <i class="fa fa-calendar"></i>
    <a href="/2015/10/13/Save-Beta-Rabbit-Google-Challenge/">
      <time datetime="2015-10-13T04:58:36.000Z" itemprop="datePublished">2015-10-13</time>
    </a>
  </div>


          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/categories/Interview/">Interview</a><i class="fa fa-angle-right"></i><a class="article-category-link" href="/categories/Interview/Google-Challenge/">Google Challenge</a>
  </div>

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>终于有个空闲时间做下一题的Google Challenge, 题目如下,</p>
<blockquote>
<p><strong><em>Save Beta Rabbit</em></strong><br>Oh no! The mad Professor Boolean has trapped Beta Rabbit in an NxN grid of rooms. In the center of each room (except for the top left room) is a hungry zombie. In order to be freed, and to avoid being eaten, Beta Rabbit must move through this grid and feed the zombies.</p>
<p>Beta Rabbit starts at the top left room of the grid. For each room in the grid, there is a door to the room above, below, left, and right. There is no door in cases where there is no room in that direction. However, the doors are locked in such a way that Beta Rabbit can only ever move to the room below or to the right. Once Beta Rabbit enters a room, the zombie immediately starts crawling towards him, and he must feed the zombie until it is full to ward it off. Thankfully,<br>Beta Rabbit took a class about zombies and knows how many units of food each zombie needs be full.</p>
<p>To be freed, Beta Rabbit needs to make his way to the bottom right room (which also has a hungry zombie) and have used most of the limited food he has. He decides to take the path through the grid such that he ends up with as little food as possible at the end.</p>
<p>Write a function answer(food, grid) that returns the number of units of food Beta Rabbit will have at the end, given that he takes a route using up as much food as possible without him being eaten, and ends at the bottom right room. If there does not exist a route in which Beta Rabbit will not be eaten, then return -1.</p>
<p>food is the amount of food Beta Rabbit starts with, and will be a positive integer no larger than 200.</p>
<p>grid will be a list of N elements. Each element of grid will itself be a list of N integers each, denoting a single row of N rooms. The first element of grid will be the list denoting the top row, the second element will be the list denoting second row from the top, and so on until the last element, which is the list denoting the bottom row. In the list denoting a single row, the first element will be the amount of food the zombie in the left-most room in that row needs, the<br>second element will be the amount the zombie in the room to its immediate right needs and so on. The top left room will always contain the integer 0, to indicate that there is no zombie there.</p>
<p>The number of rows N will not exceed 20, and the amount of food each zombie requires will be a positive integer not exceeding 10.</p>
<p><strong><em>Test cases</em></strong></p>
<p>Inputs:<br>(int) food = 7<br>(int) grid = [[0, 2, 5], [1, 1, 3], [2, 1, 1]]<br>Output:<br>(int) 0</p>
<p>Inputs:<br>(int) food = 12<br>(int) grid = [[0, 2, 5], [1, 1, 3], [2, 1, 1]]<br>Output:<br>(int) 1</p>
</blockquote>
<p>如果去掉 “He decides to take the path through the grid such that he ends up with as little food as possible at the end.” 这个条件的话，可以以时间复杂度为O(n) 的运行时间完成。 加入这个新的限制条件，目测题目需要二维动态规划。（题目提供时间为96hours），现在开始想。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="tyleryang.github.io/2015/10/13/Save-Beta-Rabbit-Google-Challenge/" data-id="cift9a0q50015t342h63z2fup" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Algorithm/">Algorithm</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Google-Challenge/">Google Challenge</a></li></ul>

    </footer>
  </div>
  
</article>



    
      <article id="post-系统化思维-Life" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/10/09/系统化思维-Life/">系统化思维 - Life</a>
    </h1>
  

        <div class="article-meta">
          
  <div class="article-date">
    <i class="fa fa-calendar"></i>
    <a href="/2015/10/09/系统化思维-Life/">
      <time datetime="2015-10-08T16:30:15.000Z" itemprop="datePublished">2015-10-09</time>
    </a>
  </div>


          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/categories/Life/">Life</a>
  </div>

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>感觉毕业两年来，一直在想着怎么去学多点东西，却忘了工程思维的必要性。 仔细看看自己掌握的知识，一点点问确实可以答出来，现在看来自己的点无法连成一个面。导致的结果就是，条理化系统化思考欠缺。</p>
<p>该好好整理下自己的知识树。加强系统设计方面的能力，表达能力，条理化思维。</p>
<p>个人能力的上升一定是基于坚实基础之上，坚实的基础并不只是靠一下一下的练习就可以获得，而是要在正确的训练方式之上，加入自己的思考。一次次的理清思路才能让自己掌握的知识连接起来。</p>
<p>收获颇丰的一天，练得多，并不意味着你就强。制定好计划，掌握好方向之余要自省。人外人天外天。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="tyleryang.github.io/2015/10/09/系统化思维-Life/" data-id="cift9a0p1000bt342o8mv8c7r" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Life/">Life</a></li></ul>

    </footer>
  </div>
  
</article>



    
      <article id="post-Shortest-Palindrome-Leetcode" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/10/06/Shortest-Palindrome-Leetcode/">Shortest Palindrome - Leetcode</a>
    </h1>
  

        <div class="article-meta">
          
  <div class="article-date">
    <i class="fa fa-calendar"></i>
    <a href="/2015/10/06/Shortest-Palindrome-Leetcode/">
      <time datetime="2015-10-06T08:43:00.000Z" itemprop="datePublished">2015-10-06</time>
    </a>
  </div>


          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/categories/Interview/">Interview</a><i class="fa fa-angle-right"></i><a class="article-category-link" href="/categories/Interview/Leetcode/">Leetcode</a>
  </div>

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>已经很久没刷题了，国庆期间重新刷了几题，复习了下 DFA, kmp algorithm, 有向图的环检测, 拓扑排序等。</p>
<p>最近对算法一个感受就是，算法跟英文很像，学的时候总是不知道有什么用，偏偏就会有时候需要用上。 比如有向环的检测跟拓扑排序，学图数据结构跟算法的时候总是觉得这些东西可能在一些比较高大上的东西上才会用到。直到半年前自己想写一个依赖注入的js 版本实现的时候突然就懵了。 </p>
<p>写个依赖注入在简单的利用function.toString() 之后利用正则表达式获得各个依赖名称时候的难度都还好，直到检测依赖是否成环的时候，需要用到的便是图里面的有向图的环检测，也就是dfs。</p>
<p>这题<a href="https://leetcode.com/problems/shortest-palindrome/" target="_blank" rel="external">Shortest Palindrome</a> 在leetcode 的通过率为17%，难度为Hard. 个人认为还是比较有意思的题目.</p>
<blockquote>
<p>Given a string S, you are allowed to convert it to a palindrome by adding characters in front of it. Find and return the shortest palindrome you can find by performing this transformation.</p>
<p>For example:<br>Given “aacecaaa”, return “aaacecaaa”.</p>
<p>Given “abcd”, return “dcbabcd”.</p>
</blockquote>
<h3 id="分析">分析</h3><p>刚开始看到这题想法是很简单，以为跟找最长子串匹配应该是同一个解法，也就是动态规划的方法。后面发现跑起来在大数据集的时候还比暴力匹配更慢. </p>
<p>仔细思考了一下后发现最短的回文其实是从头上开始找到后面能匹配的尽可能长的回文子串，举个例子<code>aabcbaaa</code> 能找到从头部开始尽可能长的回文子串为<code>aabcbaa</code>。思路上还是动态规划，却发现无论如何都有很多无用的操作。最后 google 了下，发现最佳的做法（时间复杂度为线性）是kmp 算法。</p>
<p>具体做法为 <code>aabcbaaa</code> + <code>aaabcbaa</code>(前者的逆子串）之后用kmp 的prefix 处理生成next 跳转数组后，找到能match 的最长回文逆子串。比如 对于字符串s(<code>aabcbaaa</code>)先reverse 再concat 之后生成的字符串为str(<code>aabcbaaaaaabcbaa</code>)。 这时候的next 跳转数组应该为</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a  a   b  c  b  a  a  a  a  a  a  b  c  b  a  a&#10;-1  0  -1 -1 -1  0  1  0  1  0  1  2  3  4  5  6</span><br></pre></td></tr></table></figure>
<p>这时候会发现能找到的最长逆子串长度应该为6 + 1 =&gt; 7. 这是只需要new StringBuffer(s.substring(7)).reverse() + s 便为最终解答。</p>
<p>以下为具体的java 实现，</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">shortestPalindrome</span><span class="params">(String s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(s == <span class="keyword">null</span> || s.length() == <span class="number">0</span>) <span class="keyword">return</span> s;</span><br><span class="line">        StringBuffer sBuff = <span class="keyword">new</span> StringBuffer(s);</span><br><span class="line"></span><br><span class="line">        String str = s + sBuff.reverse().toString();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span>[] next = genNext(str);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> l = next[next.length - <span class="number">1</span>] + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(l == str.length() - <span class="number">1</span> || l == s.length()) &#123;</span><br><span class="line">            <span class="keyword">return</span> s;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(l &gt; s.length()) &#123;</span><br><span class="line">            l++;</span><br><span class="line">        &#125;</span><br><span class="line">        l %= s.length();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> StringBuffer(s.substring(l)).reverse().toString() + s; </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span>[] genNext(String pattern) &#123;</span><br><span class="line">        <span class="keyword">int</span>[] next = <span class="keyword">new</span> <span class="keyword">int</span>[pattern.length()];</span><br><span class="line">        next[<span class="number">0</span>] = -<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; pattern.length(); i++) &#123;</span><br><span class="line">            <span class="keyword">int</span> index = next[i - <span class="number">1</span>];</span><br><span class="line">            <span class="keyword">while</span>(index &gt;= <span class="number">0</span> &amp;&amp; pattern.charAt(index + <span class="number">1</span>) != pattern.charAt(i)) &#123;</span><br><span class="line">                index = next[index];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(pattern.charAt(index + <span class="number">1</span>) == pattern.charAt(i)) &#123;</span><br><span class="line">                next[i] = index + <span class="number">1</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                next[i] = -<span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> next;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><a href="https://github.com/TylerYang/leetcode/blob/master/214.ShortestPalindrome/Solution.java" target="_blank" rel="external">完整版本</a></p>
<h3 id="总结">总结</h3><p>这题感觉综合性在leetcode 里面算是比较强的。至少让我复习了kmp 这个算法以及dfa 的相关概念。kmp 的prefix 的实现感觉上还是比较tricky，写出伪代码然后去一步步去走才能更深刻的理解。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="tyleryang.github.io/2015/10/06/Shortest-Palindrome-Leetcode/" data-id="cift9a0q0000yt342ey0zyehl" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Finite-State-Automata/">Finite State Automata</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/KMP-Algorithm/">KMP Algorithm</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Leetcode/">Leetcode</a></li></ul>

    </footer>
  </div>
  
</article>



    
      <article id="post-移动webapp工程思考" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/09/30/移动webapp工程思考/">移动webapp 优化思考 - web</a>
    </h1>
  

        <div class="article-meta">
          
  <div class="article-date">
    <i class="fa fa-calendar"></i>
    <a href="/2015/09/30/移动webapp工程思考/">
      <time datetime="2015-09-30T13:57:48.000Z" itemprop="datePublished">2015-09-30</time>
    </a>
  </div>


          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/categories/web/">web</a><i class="fa fa-angle-right"></i><a class="article-category-link" href="/categories/web/architecture/">architecture</a>
  </div>

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="起因">起因</h2><p>最近在帮助重写一个移动端h5 架构。说起来这是后话，主要起因是有个基于RequireJS 跟 AngularJS 开发的移动端HTML5 网站。 本身定义为Web Application。接到优化加载时间的需求，本着先解决主要问题的原则，做了下列事情。</p>
<ol>
<li>打开Chrome 查看打开url时候的加载时序图。</li>
<li>尝试看加载分为哪几个步骤，并调整加载时候的网络状况（Chrome自带)观察在不同网络情况下的加载速度，例如2G 与3G, 3G下又有(Good, Regular, Bad) 三个等级。</li>
</ol>
<p>发觉这个移动端站点在3G Bad 的情况下加载时间竟然约为10s。 到所有完成是12s。 也就是说，光加载资源就10s。时序图如下，</p>
<p><img src="https://raw.githubusercontent.com/TylerYang/images/master/blog/lx.png" alt="State Diagram"></p>
<h2 id="分析">分析</h2><p>从图中可以看出，整个过程大致分为三个阶段，<br>第一阶段, 加载RequireJS, 等RequireJS 加载完运行代码<br>第二阶段, 通过RequireJS 加载 main.js, main.js加载完 开始Angular 的Bootstrap, (初始化应用模块，初始化路由以及动态加载模块）<br>第三阶段, 根据当前url 动态加载对应模块的controller 以及 html，之后对页面进行渲染。</p>
<p>很明显原来的架构意图在于通过RequireJS 管理模块之间的依赖关系，并且随着页面的跳转逐渐加载新的Controller 与模版。典型的渐进加载思路，应该说是一个很美好的想法，但并不适用于当前。主要原因我认为在于当前移动网络并没有想象中这么乐观，2g 3g(regular, bad)还是比比皆是。这种通过RequireJS 来管理模块依赖，让移动端项目强依赖于RequireJS<br>的方式无论从任何页面进入项目，总会有两段不必要的时间花费（无论以何种方式优化）。</p>
<ol>
<li>加载并运行RequireJS</li>
<li>动态加载Controller 与 模版</li>
</ol>
<p>回去看项目代码，发现项目完全通过RequireJS 进行管理模块，甚至连动态加载controller 都通过RequireJS 来做，要去掉以上两点，我的看法是在开发过程中仅通过RequireJS 管理库之间的依赖，而在构建过程中把RequireJS 相关部分从项目中剥离出去。 </p>
<p>换言之，在Development 环境中仍存在RequireJS, 与动态加载部分。在Production 环境中去除 RequireJS, 把所有的第三方库合成一个文件，把所有的app 合成一个文件，html<br>编译成js。在构建过程中去除动态加载部分。</p>
<p>此时项目还不是很大，整个项目页面主要也就三十来个。我认为这时候应该优先对项目架构进行修正以减少技术债。随着时间增长，这种由于架构导致的加载性能问题只会越来越严重。并且修正起来难度会越来越大（耦合度会随着时间逐渐增加）</p>
<p>分析完主要问题，开始着手从项目中去除RequireJS 的模块管理部分以及编写构建过程。计划时间花费应该在2天左右。明天国庆回老家，后天完成。到时候不上简单示意图。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="tyleryang.github.io/2015/09/30/移动webapp工程思考/" data-id="cift9a0p6000gt342xffh4coa" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/web/">web</a></li></ul>

    </footer>
  </div>
  
</article>



    
      <article id="post-最近的生活" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/09/20/最近的生活/">最近的生活 - 生活</a>
    </h1>
  

        <div class="article-meta">
          
  <div class="article-date">
    <i class="fa fa-calendar"></i>
    <a href="/2015/09/20/最近的生活/">
      <time datetime="2015-09-20T15:23:45.000Z" itemprop="datePublished">2015-09-20</time>
    </a>
  </div>


          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/categories/Life/">Life</a>
  </div>

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>前些日子把个人博客从github 上搬到了树莓派里，给树莓派装了nodejs， git等东东。同时把家里的两级路由变成了一个网络桥接以及一个以及路由。当时弄到了晚上三点，印象颇为深刻。 </p>
<p>原先有个路由是电信那边租过来的，刚开始就被设好，后来自己买多了一个华为的荣耀路由。想着这样可以用ddns把自己的树莓派曝露到英特网下，从而可以自己setup 自己的server，将来还可以加蓝牙dangle把家里搞成小型物联网。 于是就注册了花生壳，却发现无论如何都无法从外网访问到自己的树莓派。后来发现是因为华为绑定花生壳账号的时候是把自己被电信光猫（一级路由）分配的ip<br>绑定给了花生壳，于是果断把一级路由刷掉取消拨号转为桥接，再把华为的拨号加上，搞定。</p>
<p>再之后就是开发了一个小小的angular keyboard，花了几个小时吧，写着玩。具体见github。 </p>
<p>leetcode 刷题的进度最近都下来了，工作确实很忙，晚上回来基本都是头疼，躺一会就起来健身，俯卧撑仰卧起坐啥的还是要做的。星期六日基本都会去咖啡厅刷题写代码。</p>
<p>react native 果然会慢慢活起来，还记得四月刚出的时候马上跑过去写了几个页面，写着跟twitter一样的界面，写起来毫无压力。之后上youtube 上看了react conference里面fb 的一个家伙写的animation demo，被震惊了很久。 现在react native又可以编译成android，就像发布会时说的那样，“我们相信web 的未来非常美好，但现在还是有不足之处，至少在我们等到html5 完美之前，react native 会成为我们目前最好的解决方案。” </p>
<p>前些日子上youtube 上看了不来梅大学的 suffix tree 的视频，实现起来确实蛮累的。trie tree 实现起来这么简单，但适用范围却很窄。尤记得当时面试的时候被北大哥问suffix tree跟优先队列的实现问的面红耳赤的自己,当时回来跟steven 聊了好久，steven 说了几个重要的数据结构一定要掌握，于是默默记在心中。感觉人生就是不断的遇到秒杀你的人，但人生的意义却是一次次被秒杀，一次次爬起来继续练。</p>
<p>这两天早上练了一上午球，下午跑去写了知乎的小爬虫，准备封装好基本API。顺便尝试了下koa 的东东，ECMAScript 的yield 真是蛮有意思的，刚开始以为yield 是可以解决异步问题，后来发现是koa 利用generator 解决了异步回调，google 了一下，貌似很多人都有这个误会。 另外 generator 里面的peak 运行语句的方式会是一个蛮有意思的考点吧。 koa 封装的middleware 只能赞一个。具体代码见github。 </p>
<p>好几个月没认真去stackoverflow 刷答案，昨天跑去看了一下，发现有个人提了一个问题，说是内嵌的document.write 跟用script src 引入的js脚本里面的document.write 运行结果不一致，一个只是append 文字进去，后者则是删除文档原有的markup，然后append text。 当时看到的时候也觉得很奇怪，后来第一反应是去mdn 查文档，看了一下发现是内嵌的document.write 是不会自动先调用 document.open，而document.open<br>的作用恰恰是清空整个文档。给问这个问题的人点了赞，答了题，拿了几十分。</p>
<p>早上公交时间有点长，就在车上看《编程珠玑》，一本书看了这么久，也是怪不好意思的。有些地方觉得没必要太着重，比如空间的优化，举的例子还是很久之前的。但对于马戏团的跳法觉得蛮有意思的。</p>
<p>接下来的日子，网上订了蓝牙灯泡跟蓝牙usb 接口，一方面要写知乎爬虫，之后setup 到树莓派下，然后再写一个react native 的ios app做一个知乎大百科。接着是弄好基本的物联网简易平台，从手机端用ios app 通过3g连接到树莓派，再由树莓派通过蓝牙连接到蓝牙灯泡。至少刚工作的时候做过类似的东西，做起来应该难度不大。</p>
<p>国庆节就快到了，连续七天的假期简直是一种奢侈，好好安排下自己国庆时候要刷的题目，写的项目还有就是许久未见的朋友，估计会一块约打球。不要浪费时间在不必要的时候，秉承着这个原则，几乎去哪都是最快去。有时候也会想是否错过了很多，有时候你承担的多了，你就过的不会这么轻松吧。</p>
<p>还记得那个草帽，我会去还给你的！</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="tyleryang.github.io/2015/09/20/最近的生活/" data-id="cift9a0pb000kt34294808p4t" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Life/">Life</a></li></ul>

    </footer>
  </div>
  
</article>



    
      <nav id="page-nav">
        <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
      </nav>
    </section>
      
        <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">recents</h3>
    <div class="widget">
      <ul id="recent-post" class="">
        
          <li>
            
            <div class="item-thumbnail">
              <a href="/2015/10/16/饿了么网站优化研究-web/" class="thumbnail">
  
    <span style="background-image:url(https://raw.githubusercontent.com/TylerYang/images/master/blog/m.ele.me.png
)" alt="饿了么网站优化研究 - web" class="thumbnail-image"></span>
  
</a>
            </div>
            
            <div class="item-inner">
              <p class="item-category"><a class="article-category-link" href="/categories/web/">web</a><i class="fa fa-angle-right"></i><a class="article-category-link" href="/categories/web/architecture/">architecture</a></p>
              <p class="item-title"><a href="/2015/10/16/饿了么网站优化研究-web/" class="title">饿了么网站优化研究 - web</a></p>
              <p class="item-date"><time datetime="2015-10-16T06:06:20.000Z" itemprop="datePublished">2015-10-16</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-thumbnail">
              <a href="/2015/10/13/Save-Beta-Rabbit-Google-Challenge/" class="thumbnail">
  
    <span class="thumbnail-image thumbnail-none"></span>
  
</a>
            </div>
            
            <div class="item-inner">
              <p class="item-category"><a class="article-category-link" href="/categories/Interview/">Interview</a><i class="fa fa-angle-right"></i><a class="article-category-link" href="/categories/Interview/Google-Challenge/">Google Challenge</a></p>
              <p class="item-title"><a href="/2015/10/13/Save-Beta-Rabbit-Google-Challenge/" class="title">Save Beta Rabbit - Google Challenge</a></p>
              <p class="item-date"><time datetime="2015-10-13T04:58:36.000Z" itemprop="datePublished">2015-10-13</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-thumbnail">
              <a href="/2015/10/09/系统化思维-Life/" class="thumbnail">
  
    <span class="thumbnail-image thumbnail-none"></span>
  
</a>
            </div>
            
            <div class="item-inner">
              <p class="item-category"><a class="article-category-link" href="/categories/Life/">Life</a></p>
              <p class="item-title"><a href="/2015/10/09/系统化思维-Life/" class="title">系统化思维 - Life</a></p>
              <p class="item-date"><time datetime="2015-10-08T16:30:15.000Z" itemprop="datePublished">2015-10-09</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-thumbnail">
              <a href="/2015/10/06/Shortest-Palindrome-Leetcode/" class="thumbnail">
  
    <span class="thumbnail-image thumbnail-none"></span>
  
</a>
            </div>
            
            <div class="item-inner">
              <p class="item-category"><a class="article-category-link" href="/categories/Interview/">Interview</a><i class="fa fa-angle-right"></i><a class="article-category-link" href="/categories/Interview/Leetcode/">Leetcode</a></p>
              <p class="item-title"><a href="/2015/10/06/Shortest-Palindrome-Leetcode/" class="title">Shortest Palindrome - Leetcode</a></p>
              <p class="item-date"><time datetime="2015-10-06T08:43:00.000Z" itemprop="datePublished">2015-10-06</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-thumbnail">
              <a href="/2015/09/30/移动webapp工程思考/" class="thumbnail">
  
    <span style="background-image:url(https://raw.githubusercontent.com/TylerYang/images/master/blog/lx.png
)" alt="移动webapp 优化思考 - web" class="thumbnail-image"></span>
  
</a>
            </div>
            
            <div class="item-inner">
              <p class="item-category"><a class="article-category-link" href="/categories/web/">web</a><i class="fa fa-angle-right"></i><a class="article-category-link" href="/categories/web/architecture/">architecture</a></p>
              <p class="item-title"><a href="/2015/09/30/移动webapp工程思考/" class="title">移动webapp 优化思考 - web</a></p>
              <p class="item-date"><time datetime="2015-09-30T13:57:48.000Z" itemprop="datePublished">2015-09-30</time></p>
            </div>
          </li>
        
      </ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Interview/">Interview</a><span class="category-list-count">6</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Interview/Google-Challenge/">Google Challenge</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Interview/Leetcode/">Leetcode</a><span class="category-list-count">4</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Language/">Language</a><span class="category-list-count">1</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Language/Javascript/">Javascript</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Life/">Life</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/web/">web</a><span class="category-list-count">2</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/web/architecture/">architecture</a><span class="category-list-count">2</span></li></ul></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Algorithm/">Algorithm</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CSAPP/">CSAPP</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Dynamic-Programming/">Dynamic Programming</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Finite-State-Automata/">Finite State Automata</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Google-Challenge/">Google Challenge</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Greedy-Algorithm/">Greedy Algorithm</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/KMP-Algorithm/">KMP Algorithm</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Leetcode/">Leetcode</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Life/">Life</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/State-Machine/">State Machine</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/design-pattern/">design pattern</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/javascript/">javascript</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web/">web</a><span class="tag-list-count">2</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">tag cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Algorithm/" style="font-size: 15px;">Algorithm</a> <a href="/tags/CSAPP/" style="font-size: 10px;">CSAPP</a> <a href="/tags/Dynamic-Programming/" style="font-size: 10px;">Dynamic Programming</a> <a href="/tags/Finite-State-Automata/" style="font-size: 15px;">Finite State Automata</a> <a href="/tags/Google-Challenge/" style="font-size: 15px;">Google Challenge</a> <a href="/tags/Greedy-Algorithm/" style="font-size: 10px;">Greedy Algorithm</a> <a href="/tags/KMP-Algorithm/" style="font-size: 10px;">KMP Algorithm</a> <a href="/tags/Leetcode/" style="font-size: 20px;">Leetcode</a> <a href="/tags/Life/" style="font-size: 15px;">Life</a> <a href="/tags/State-Machine/" style="font-size: 10px;">State Machine</a> <a href="/tags/design-pattern/" style="font-size: 10px;">design pattern</a> <a href="/tags/javascript/" style="font-size: 15px;">javascript</a> <a href="/tags/web/" style="font-size: 15px;">web</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/10/">October 2015</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/09/">September 2015</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/08/">August 2015</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/07/">July 2015</a><span class="archive-list-count">2</span></li></ul>
    </div>
  </div>

  
  <div id="toTop" class="fa fa-chevron-up"></div>
</aside>
      
    </div>
    <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2015 Tyler Yang<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>. Theme by <a href="http://github.com/ppoffice">PPOffice</a>
    </div>
  </div>
</footer>
    


<script src="//ajax.useso.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
  <script src="/fancybox/jquery.fancybox.pack.js" type="text/javascript"></script>


<script src="/js/script.js" type="text/javascript"></script>

  </div>
</body>
</html>